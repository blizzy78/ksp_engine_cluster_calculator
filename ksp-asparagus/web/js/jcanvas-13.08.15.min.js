/**
 * jCanvas v13.08.15
 * Copyright 2013 Caleb Evans
 * Released under the MIT license
 */(function(e,t,n,r,i,s,o,u,a){function Nn(e){var t=this;an(t,e);return t}function Cn(e){e?an(Nn.prototype,e):Cn.prefs=Nn.prototype=an({},un);return this}function kn(e){return ln(e)==="string"}function Ln(e){return e&&e[O]?e[O]("2d"):u}function An(e){e=an({},e);e.masks=e.masks[Y](0);return e}function On(e,t){e.save();t[M].push(An(t[p]))}function Mn(e,t){if(t[M][f]===0)t[p]=An(Sn);else{e[lt]();t[p]=t[M].pop()}}function _n(e,t,n){cn(n[w])?t[w]=n[w][y](e,n):t[w]=n[w];cn(n[N])?t[N]=n[N][y](e,n):t[N]=n[N];t.lineWidth=n[gt];if(n.rounded)t.lineCap=t.lineJoin="round";else{t.lineCap=n.strokeCap;t.lineJoin=n.strokeJoin;t.miterLimit=n.miterLimit}t.shadowOffsetX=n.shadowX;t.shadowOffsetY=n.shadowY;t[Et]=n[Et];t[v]=n[v];t.globalAlpha=n.opacity;t.globalCompositeOperation=n.compositing;n[Ft]&&(t.webkitImageSmoothingEnabled=t.mozImageSmoothingEnabled=n[Ft])}function Dn(e,t,n){if(n.mask){n[yt]&&On(e,t);e.clip();t[p].masks.push(n._args)}}function Pn(e,t){t._transformed&&e[lt]()}function Hn(e,t,n){var r;n[ft]&&t[V]();if(n.shadowStroke&&n[gt]!==0){t.stroke();t.fill();t[v]=h;t[Et]=0;t.stroke()}else{t.fill();n[w]!==h&&(t[v]=h);n[gt]!==0&&t.stroke()}n[ft]||t[V]();Pn(t,n);if(n.mask){r=qn(e);Dn(t,r,n)}}function Bn(e,t,n){t[B]=t[kt]?pn/180:1;e[x](t.x,t.y);e[ht](t[ht]*t[B]);e[x](-t.x,-t.y);n[ht]+=t[ht]*t[B]}function jn(e,t,n){t.scale!==1&&(t[pt]=t[ct]=t.scale);e[x](t.x,t.y);e.scale(t[pt],t[ct]);e[x](-t.x,-t.y);n[pt]*=t[pt];n[ct]*=t[ct]}function Fn(e,t,n){t[x]&&(t[I]=t[F]=t[x]);e[x](t[I],t[F]);n[I]+=t[I];n[F]+=t[F]}function In(e,t,n,r,i){n[B]=n[kt]?pn/180:1;n._transformed=s;t.save();i===a&&(i=r);if(!n.fromCenter&&!n._centered){n.x+=r/2;n.y+=i/2;n._centered=s}n[ht]&&Bn(t,n,{});(n.scale!==1||n[pt]!==1||n[ct]!==1)&&jn(t,n,{});(n[x]||n[I]||n[F])&&Fn(t,n,{})}function qn(t){var n;if(wn._canvas===t&&wn._data)n=wn._data;else{n=e.data(t,ut);if(!n){n={canvas:t,layers:[],layer:{names:{},groups:{}},intersecting:[],drag:{},event:{type:u,x:u,y:u},events:{},transforms:An(Sn),savedTransforms:[],animating:o,animated:u,pixelRatio:1,scaled:!1};e.data(t,ut,n)}wn._canvas=t;wn._data=n}return n}function Rn(e,t,n){var r;for(r in Cn[j])Cn[j][It](r)&&n[r]&&Un(e,t,n,r)}function Un(e,t,n,r){r=nr(r);Cn[j][r](e,t);n[S]=s}function zn(e,t,n){var r,i,o;if(n[W]||n[Tt]){r=[U,P,it];for(o=0;o<r[f];o+=1){i=r[o];Un(e,t,n,i)}if(!t[j].mouseoutdrag){e.bind("mouseout.jCanvas",function(){var n=t.drag[L];if(n){t.drag={};n.dragcancel&&n.dragcancel[y](e[0],n);e[H]()}});t[j].mouseoutdrag=s}n[S]=s}}function Wn(e,t,n,r){var i=t[L].names;r?r[$]!==a&&kn(n[$])&&n[$]!==r[$]&&delete i[n[$]]:r=n;kn(r[$])&&(i[r[$]]=n)}function Xn(e,t,n,r){var i=t[L][d],s,o,l,c,h;if(n[$t]!==u){n[d]=[n[$t]];n[Ht]&&(n[dt]=[n[$t]])}if(r&&r[$t]!==a)if(r[$t]===u)r[d]=u;else{r[d]=[r[$t]];r[Ht]&&(r[dt]=[r[$t]])}if(!r)r=n;else if(r[d]!==a&&n[d]!==u)for(l=0;l<n[d][f];l+=1){o=n[d][l];s=i[o];if(s){for(h=0;h<s[f];h+=1)if(s[h]===n){c=h;s[m](h,1);break}s[f]===0&&delete i[o]}}if(r[d]!==a&&r[d]!==u)for(l=0;l<r[d][f];l+=1){o=r[d][l];s=i[o];if(!s){s=i[o]=[];s[$]=o}c===a&&(c=s[f]);s[m](c,0,n)}}function Vn(e){var t,n,r;t={};for(n=e[K][f]-1;n>=0;n-=1){t=e[K][n];if(t[Xt]){for(r=t[Xt][f]-1;r>=0;r-=1)if(!t[Xt][r][J]){t[J]=o;break}if(t[J])break}}return t}function $n(e,t,n){var r,i,u,a,l,c,h,p;a=t.drag;i=a[L];l=i[dt]||[];r=t.layers;if(n===P||n===vt){if(!a[Dt]){a[Dt]=s;if(i.bringToFront){r[m](i[D],1);i[D]=r.push(i)}for(p=0;p<l[f];p+=1){h=l[p];c=t[L][d][h];if(i[d]&&c)for(u=0;u<c[f];u+=1)if(c[u]!==i){c[u][At]=c[u].x;c[u][Lt]=c[u].y;c[u]._endX=i[ot];c[u]._endY=i[tt];if(c[u].bringToFront){c[u][D]=fn(c[u],r);r[m](c[u][D],1);r[m](-1,0,c[u]);c[u][D]=r[f]-2}c[u][xt]&&c[u][xt][y](e,c[u])}}a[At]=i[At]=i.x;a[Lt]=i[Lt]=i.y;a._endX=i._endX=i[ot];a._endY=i._endY=i[tt];i[xt]&&i[xt][y](e,i)}i.x=i[ot]-(a._endX-a[At]);i.y=i[tt]-(a._endY-a[Lt]);for(p=0;p<l[f];p+=1){h=l[p];c=t[L][d][h];if(i[d]&&c)for(u=0;u<c[f];u+=1)if(c[u]!==i){c[u].x=i[ot]-(c[u]._endX-c[u][At]);c[u].y=i[tt]-(c[u]._endY-c[u][Lt]);c[u].drag&&c[u].drag[y](e,c[u])}}i.drag&&i.drag[y](e,i)}else if(n===it||n===wt){if(i[Mt]&&a[Dt]){i[Mt][y](e,i);a[Dt]=o}for(p=0;p<l[f];p+=1){h=l[p];c=t[L][d][h];if(i[d]&&c)for(u=0;u<c[f];u+=1)c[u]!==i&&c[u][Mt]&&c[u][Mt][y](e,c[u])}t.drag={}}}function Jn(e,t,n,r){if(n&&n[E]&&n[A]){r?n._next=r:n._next=u;n[A][y](e,n)}}function Kn(t,n,r,i){var o,a,l=r,c;n._args=r;n.canvas=t;if(n[W]||n[dt]){n[L]=s;n[W]=s}i?n[A]=i:n.method?n[A]=e.fn[n.method]:n.type?n[A]=e.fn[bn[n.type]]:n[A]=function(){};if(n[L]&&!n._layer){o=e(t);a=o[T]();c=qn(t);l=new Nn(new Nn(r));l[A]=n[A];l.canvas=n.canvas;l[W]=n[W];l[L]=s;l._layer=s;Wn(o,c,l);Xn(o,c,l);Rn(o,c,l);zn(o,c,l);n[S]=l[S];l[D]===u&&(l[D]=a[f]);a[m](l[D],0,l)}return l}function Qn(e){var t;for(t=0;t<xn[f];t+=1)e[xn[t]]=e["_"+xn[t]]}function Gn(e,t){var n;for(n=0;n<xn[f];n+=1){e["_"+xn[n]]=e[xn[n]];Tn[xn[n]]=1;t&&delete e[xn[n]]}}function Yn(e,t,n){var r;for(r in n)n[It](r)&&cn(n[r])&&(n[r]=n[r][y](e,t,r));return n}function Zn(n){var r,s,o=[],u=1;if(n[en](/^#?\w+$/gi)){n===h&&(n="rgba(0,0,0,0)");s=t.head;r=s[Ct][jt];s[Ct][jt]=n;n=e.css(s,jt);s[Ct][jt]=r}if(n[en](/^rgb/gi)){o=n[en](/\d+/gi);n[en](/%/gi)&&(u=2.55);o[0]*=u;o[1]*=u;o[2]*=u;o[3]!==a?o[3]=i(o[3]):o[3]=1}return o}function er(e){var t=3,n;if(ln(e[R])!=="array"){e[R]=Zn(e[R]);e.end=Zn(e.end)}e.now=[];if(e[R][3]!==1||e.end[3]!==1)t=4;for(n=0;n<t;n+=1){e.now[n]=e[R][n]+(e.end[n]-e[R][n])*e.pos;n<3&&(e.now[n]=hn(e.now[n]))}if(e[R][3]!==1||e.end[3]!==1)e.now="rgba("+e.now.join(",")+")";else{e.now[Y](0,3);e.now="rgb("+e.now.join(",")+")"}e.elem.nodeName?e.elem[Ct][e.prop]=e.now:e.elem[e.prop]=e.now}function tr(t){var n;for(n=0;n<t[f];n+=1)e.fx.step[t[n]]=er}function nr(e){window.ontouchstart!==undefined&&gn[e]&&(e=gn[e]);return e}function rr(e){yn[e]&&(e=yn[e]);return e}function ir(e){Cn[j][e]=function(t,n){var r,i;i=n[et];r=e===X||e===Z?P:e;if(!n[j][r]){t.bind(r+".jCanvas",function(e){i.x=e[Kt];i.y=e.offsetY;i.type=r;i[et]=e;t[H]({resetFire:s});e.preventDefault()});n[j][r]=s}}}function sr(e){var t;for(t=0;t<e[f];t+=1)ir(e[t])}function or(e,t,n){var r,i,o,a,f,l,c,h;r=n._args;if(r[S]){i=qn(e);o=i[et];if(o.x!==u&&o.y!==u){l=o.x*i[Rt];c=o.y*i[Rt];a=t.isPointInPath(l,c)||t[Vt]&&t[Vt](l,c)}f=i[p];r.eventX=r.mouseX=o.x;r.eventY=r.mouseY=o.y;r[et]=o[et];h=i[p][ht];l=r.eventX;c=r.eventY;if(h!==0){r[ot]=l*vn(-h)-c*dn(-h);r[tt]=c*vn(-h)+l*dn(-h)}else{r[ot]=l;r[tt]=c}r[ot]/=f[pt];r[tt]/=f[ct];!a&&r[_t]&&!r[St]&&(r[qt]=s);a&&i[K].push(r);r[J]=a}}function ur(e,t){isNaN(Number(t[k]))||(t[k]+="px");e.font=t[Jt]+" "+t[k]+" "+t[Ut]}function ar(t,n,r,s){var o,u,a;if(wn.text===r.text&&wn[Jt]===r[Jt]&&wn[k]===r[k]&&wn[Ut]===r[Ut]&&wn[Ot]===r[Ot]&&wn[nt]===r[nt]){r[c]=wn[c];r[l]=wn[l]}else{r[c]=n[q](s[0])[c];for(a=1;a<s[f];a+=1){u=n[q](s[a])[c];u>r[c]&&(r[c]=u)}o=t[Ct][k];t[Ct][k]=r[k];r[l]=i(e.css(t,k))*s[f]*r[nt];t[Ct][k]=o}}function fr(e,t){var n=t.text,r=t[Ot],i=n.split(" "),s,o=[],u="";if(i[f]===1||e[q](n)[c]<r)o=[n];else{for(s=0;s<i[f];s+=1){if(e[q](u+i[s])[c]>r){u!==""&&o.push(u);u=""}u+=i[s];s!==i[f]-1&&(u+=" ")}o.push(u)}o=o.join("\n").replace(/( (\n))|( $)/gi,"$2").split("\n");return o}var f="length",l="height",c="width",h="transparent",p="transforms",d="groups",v="shadowColor",m="splice",g="beginPath",y="call",b="getLayer",w="fillStyle",E="visible",S="_event",x="translate",T="getLayers",N="strokeStyle",C="getLayerGroup",k="fontSize",L="layer",A="_method",O="getContext",M="savedTransforms",_="sHeight",D="index",P="mousemove",H="drawLayers",B="_toRad",j="events",F="translateY",I="translateX",q="measureText",R="start",U="mousedown",z="sWidth",W="draggable",X="mouseover",V="closePath",$="name",J="intersects",K="intersecting",Q="drawImage",G="radius",Y="slice",Z="mouseout",et="event",tt="_eventY",nt="lineHeight",rt="lineTo",it="mouseup",st="animating",ot="_eventX",ut="jCanvas",at="touchstart",ft="closed",lt="restore",ct="scaleY",ht="rotate",pt="scaleX",dt="dragGroups",vt="touchmove",mt="setLayer",gt="strokeWidth",yt="autosave",bt="bezierCurveTo",wt="touchend",Et="shadowBlur",St="_fired",xt="dragstart",Tt="cursor",Nt="concavity",Ct="style",kt="inDegrees",Lt="_startY",At="_startX",Ot="maxWidth",Mt="dragstop",_t="_hovered",Dt="dragging",Pt="animated",Ht="dragGroupWithLayer",Bt="_animating",jt="color",Ft="imageSmoothing",It="hasOwnProperty",qt="_mousedout",Rt="pixelRatio",Ut="fontFamily",zt="<canvas />",Wt="drawQuadratic",Xt="_masks",Vt="isPointInStroke",$t="group",Jt="fontStyle",Kt="offsetX",Qt="moveTo",Gt="drawEllipse",Yt="drawPolygon",Zt="load",en="match",tn="drawVector",nn="complete",rn="drawBezier",sn="restoreCanvas",on="createPattern",un,an=e.extend,fn=e.inArray,ln=e.type,cn=e.isFunction,hn=r.round,pn=r.PI,dn=r.sin,vn=r.cos,mn=e[et].fix,gn,yn,bn,wn={},En={},Sn={rotate:0,scaleX:1,scaleY:1,translateX:0,translateY:0,masks:[]},xn,Tn;e.fn[ut]=Cn;Cn[j]={};un={align:"center",autosave:s,baseline:"middle",bringToFront:o,ccw:o,closed:o,compositing:"source-over",concavity:0,cornerRadius:0,count:1,cropFromCenter:s,disableDrag:o,disableEvents:o,domain:u,draggable:o,dragGroupWithLayer:o,dragGroups:u,group:u,groups:u,data:{},each:u,end:360,fillStyle:h,font:"",fontStyle:"normal",fontSize:"12pt",fontFamily:"sans-serif",fromCenter:s,fn:u,graph:"y",height:u,imageSmoothing:s,inDegrees:s,index:u,lineHeight:1,layer:o,load:u,mask:o,maxWidth:u,miterLimit:10,name:u,opacity:1,projection:0,r1:u,r2:u,radius:0,range:u,repeat:"repeat",respectAlign:o,rotate:0,rounded:o,scale:1,scaleX:1,scaleY:1,shadowBlur:0,shadowColor:h,shadowStroke:!1,shadowX:0,shadowY:0,sHeight:u,sides:0,source:"",spread:0,start:0,strokeCap:"butt",strokeJoin:"miter",strokeStyle:h,strokeWidth:1,sWidth:u,sx:u,sy:u,text:"",translate:0,translateX:0,translateY:0,type:u,visible:s,width:u,x:0,y:0};Cn();Cn.extend=function(n){Cn.defaults=an(un,n.props);Cn();n[$]&&(e.fn[n[$]]=function r(e){var t=this,i,s,o,u=new Nn(e);for(s=0;s<t[f];s+=1){i=t[s];o=Ln(i);if(o){e=Kn(i,u,e,r);_n(i,o,u);n.fn[y](i,o,u)}}return t});return e.fn[n[$]]};e.fn[T]=function(t){var n=this[0],r,i,s=[];if(n&&n[O]){r=qn(n).layers;if(cn(t))for(i=0;i<r[f];i+=1)t[y](n,r[i])&&s.push(r[i]);else s=r}return s};e.fn[b]=function(t){var n=this[T](),r=ln(t),i=qn(this[0]),s,o;if(t&&t[L])s=t;else if(r==="number"){t<0&&(t=n[f]+t);s=n[t]}else if(r==="regexp"){for(o=0;o<n[f];o+=1)if(kn(n[o][$])&&n[o][$][en](t)){s=n[o];break}}else{i=qn(this[0]);s=i[L].names[t]}return s};e.fn[C]=function(t){var n=ln(t),r,i,s,o;if(n==="array")return t;if(n==="regexp"){o=qn(this[0]);r=o[d];for(i in r)if(i[en](t)){s=r[i];break}}else{o=qn(this[0]);s=o[L][d][t]}return s};e.fn.getLayerIndex=function(t){var n=this[T](),r=this[b](t);return fn(r,n)};e.fn[mt]=function(n,r){var i=this,s,o,u,l;for(o=0;o<i[f];o+=1){s=e(i[o]);u=qn(i[o]);l=e(i[o])[b](n);if(l){Wn(s,u,l,r);Xn(s,u,l,r);r[D]!==a&&s.moveLayer(l,r[D]);an(l,r);Rn(s,u,l);zn(s,u,l)}}return i};e.fn.setLayerGroup=function(n,r){var i=this,s,o,u,a;for(o=0;o<i[f];o+=1){s=e(i[o]);u=s[C](n);if(u)for(a=0;a<u[f];a+=1)s[mt](u[a],r)}return i};e.fn.setLayers=function(n){var r=this,i,s,o,u;for(s=0;s<r[f];s+=1){i=e(r[s]);o=e(r[s])[T]();for(u=0;u<o[f];u+=1)i[mt](o[u],n)}return r};e.fn.moveLayer=function(n,r){var i=this,s,o,u,a;for(o=0;o<i[f];o+=1){s=e(i[o]);u=s[T]();a=s[b](n);if(a){a[D]=fn(a,u);u[m](a[D],1);u[m](r,0,a);r<0&&(r=u[f]+r);a[D]=r}}return i};e.fn.removeLayer=function(n){var r=this,i,s,o,a,l;for(s=0;s<r[f];s+=1){i=e(r[s]);o=qn(r[s]);a=i[T]();l=i[b](n);if(l){l[D]=fn(l,a);a[m](l[D],1);Wn(i,o,l,{name:u});Xn(i,o,l,{groups:u})}}return r};e.fn.removeLayerGroup=function(n){var r=this,i,s,o,l,c,h,p;if(n!==a)for(s=0;s<r[f];s+=1){i=e(r[s]);o=qn(r[s]);l=i[T]();c=i[C](n);if(c){for(p=0;p<c[f];p+=1){h=c[p];h[D]=fn(h,l);l[m](h[D],1);Wn(i,o,h,{name:u})}delete o[L][d][c[$]]}}return r};e.fn.removeLayers=function(){var n=this,r,i,s;for(i=0;i<n[f];i+=1){r=e(n[i]);s=qn(n[i]);s.layers[f]=0;s[L].names={};s[L][d]={}}return n};e.fn.addLayerToGroup=function(t,n){var r=this,i,s,o,u=[];for(s=0;s<r[f];s+=1){i=e(r[s]);o=i[b](t);if(o[d]&&fn(n,o[d])===-1){u=o[d][Y](0);u.push(n);i[mt](o,{groups:u})}}return r};e.fn.removeLayerFromGroup=function(t,n){var r=this,i,s,o,u=[],a;for(s=0;s<r[f];s+=1){i=e(r[s]);o=i[b](t);a=fn(n,o[d]);if(a!==-1){u=o[d][Y](0);u[m](a,1);i[mt](o,{groups:u})}}return r};e.fn.drawLayer=function(n){var r=this,i,s,o,u;for(i=0;i<r[f];i+=1){o=e(r[i]);s=Ln(r[i]);u=o[b](n);Jn(o,s,u)}return r};e.fn[H]=function(n){var r=this,i,a,l,c=an({},n),h,d,v,m,g,b,w,x,T;c[D]||(c[D]=0);for(a=0;a<r[f];a+=1){i=e(r[a]);l=Ln(r[a]);if(l){g=qn(r[a]);c.clear!==o&&i.clearCanvas();h=g.layers;for(v=c[D];v<h[f];v+=1){d=h[v];d[D]=v;c.resetFire&&(d[St]=o);d[S]=!d.disableEvents;Jn(i,l,d,v+1);d[Xt]=g[p].masks[Y](0);if(d[qt]){d[qt]=o;d[St]=s;d[_t]=o;d[Z]&&d[Z][y](r[a],d);d[Tt]&&d._cursor&&i.css({cursor:d._cursor})}if(d[A]===e.fn[Q]&&d[E])break}m=v;d=Vn(g);b=g[et];w=b.type;d[w]||(w=rr(w));T=d[w];x=g.drag;if(d[S]&&d[J]){if(d[X]||d[Z]||d[Tt])if(!d[_t]&&!d[St]){d[St]=s;d[_t]=s;d[X]&&d[X][y](r[a],d);if(d[Tt]){d._cursor=i.css(Tt);i.css({cursor:d[Tt]})}}if(T&&!d[St]){d[St]=s;b.type=u;T[y](r[a],d)}d[W]&&!d.disableDrag&&(w===U||w===at)&&(x[L]=d)}x[L]&&$n(r[a],g,w);if(m===h[f]){g[K][f]=0;g[p]=An(Sn);g[M][f]=0}}}return r};e.fn.addLayer=function(t){var n=this,r,i,o=new Nn(t);for(r=0;r<n[f];r+=1){i=Ln(n[r]);if(i){o[L]=s;t=Kn(n[r],o,t)}}return n};xn=[c,l,"opacity",nt];Tn={};e.fn.animateLayer=function(){function g(e,t,n){return function(){Qn(n);(!t[st]||t[Pt]===n)&&e[H]();c[4]&&c[4][y](e[0],n);n[Bt]=o;t[st]=o;t[Pt]=u}}function w(e,t,n){return function(r,i){if(i.pos!==v){v=i.pos;Qn(n);if(!n[Bt]&&!t[st]){n[Bt]=s;t[st]=s;t[Pt]=n}(!t[st]||t[Pt]===n)&&e[H]();c[5]&&c[5][y](e[0],r,i,n)}}}var n=this,r,i,l,c=[][Y][y](arguments,0),h,p,d,v=0;if(ln(c[2])==="object"){c[m](2,0,c[2].duration||u);c[m](3,0,c[3].easing||u);c[m](4,0,c[4].done||c[4][nn]||u);c[m](5,0,c[5].step||u)}else{if(c[2]===a){c[m](2,0,u);c[m](3,0,u);c[m](4,0,u)}else if(cn(c[2])){c[m](2,0,u);c[m](3,0,u)}if(c[3]===a){c[3]=u;c[m](4,0,u)}else cn(c[3])&&c[m](3,0,u)}for(i=0;i<n[f];i+=1){r=e(n[i]);l=Ln(n[i]);if(l){h=qn(n[i]);p=r[b](c[0]);if(p&&p[A]!==e.fn.draw){d=an({},c[1]);d=Yn(n[i],p,d);Gn(d,s);Gn(p);p[Ct]=Tn;e(p).animate(d,{duration:c[2],easing:e.easing[c[3]]?c[3]:u,complete:g(r,h,p),step:w(r,h,p)})}}}return n};e.fn.animateLayerGroup=function(n){var r=this,i,s,o=[][Y][y](arguments,0),u,a;for(s=0;s<r[f];s+=1){i=e(r[s]);u=i[C](n);if(u)for(a=0;a<u[f];a+=1)i.animateLayer.apply(i,[u[a]].concat(o[Y](1)))}return r};e.fn.delayLayer=function(n,r){var i=this,s,o;r=r||0;for(s=0;s<i[f];s+=1){o=e(i[s])[b](n);e(o).delay(r)}return i};e.fn.delayLayerGroup=function(n,r){var i=this,s,o,u,a,l;r=r||0;for(o=0;o<i[f];o+=1){s=e(i[o]);u=s[C](n);if(u)for(l=0;l<u[f];l+=1){a=u[l];a&&e(a).delay(r)}}return i};e.fn.stopLayer=function(n,r){var i=this,s,o,u;for(o=0;o<i[f];o+=1){s=e(i[o]);u=s[b](n);u&&e(u).stop(r)}return i};e.fn.stopLayerGroup=function(n,r){var i=this,s,o,u,a,l;for(o=0;o<i[f];o+=1){s=e(i[o]);u=s[C](n);if(u)for(l=0;l<u[f];l+=1){a=u[l];a&&e(a).stop(r)}}return i};tr([jt,"backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor",w,"outlineColor",N,v]);gn={mousedown:at,mouseup:wt,mousemove:vt};yn={touchstart:U,touchend:it,touchmove:P};sr(["click","dblclick",U,it,P,X,Z,at,vt,wt]);e[et].fix=function(t){var n,r,i;t=mn[y](e[et],t);r=t.originalEvent;if(r){i=r.changedTouches;if(t.pageX!==a&&t[Kt]===a){n=e(t.target).offset();if(n){t[Kt]=t.pageX-n.left;t.offsetY=t.pageY-n.top}}else if(i){n=e(r.target).offset();if(n){t[Kt]=i[0].pageX-n.left;t.offsetY=i[0].pageY-n.top}}}return t};bn={arc:"drawArc",bezier:rn,ellipse:Gt,"function":"draw",image:Q,line:"drawLine",polygon:Yt,slice:"drawSlice",quadratic:Wt,rectangle:"drawRect",text:"drawText",vector:tn};e.fn.draw=function lr(t){var n=this,r,i,s,o;o=new Nn(t);for(i=0;i<n[f];i+=1){r=e(n[i]);s=Ln(n[i]);if(s){t=Kn(n[i],o,t,lr);o[E]&&(o.fn?o.fn[y](n[i],s,o):o[A]!==lr&&o[A][y](r,t))}}return n};e.fn.clearCanvas=function(t){var n=this,r,i,s=new Nn(t);for(r=0;r<n[f];r+=1){i=Ln(n[r]);if(i)if(s[c]===u||s[l]===u){i.save();i.setTransform(1,0,0,1,0,0);i.clearRect(0,0,n[r][c],n[r][l]);i[lt]()}else{In(n[r],i,s,s[c],s[l]);i.clearRect(s.x-s[c]/2,s.y-s[l]/2,s[c],s[l]);i[lt]()}}return n};e.fn.saveCanvas=function cr(e){var t=this,n,r,i=new Nn(e),s,o;for(n=0;n<t[f];n+=1){r=Ln(t[n]);if(r){s=qn(t[n]);e=Kn(t[n],i,e,cr);for(o=0;o<i.count;o+=1)On(r,s)}}return t};e.fn[sn]=function hr(e){var t=this,n,r,i=new Nn(e),s,o;for(n=0;n<t[f];n+=1){r=Ln(t[n]);if(r){s=qn(t[n]);e=Kn(t[n],i,e,hr);for(o=0;o<i.count;o+=1)Mn(r,s)}}return t};e.fn.restoreCanvasOnRedraw=function(t){var n=this,r=an({},t);r[L]=s;n[sn](r);return n};e.fn.rotateCanvas=function pr(e){var t=this,n,r,i=new Nn(e),s;for(n=0;n<t[f];n+=1){r=Ln(t[n]);if(r){s=qn(t[n]);e=Kn(t[n],i,e,pr);i[yt]&&On(r,s);Bn(r,i,s[p])}}return t};e.fn.scaleCanvas=function dr(e){var t=this,n,r,i=new Nn(e),s;for(n=0;n<t[f];n+=1){r=Ln(t[n]);if(r){s=qn(t[n]);e=Kn(t[n],i,e,dr);i[yt]&&On(r,s);jn(r,i,s[p])}}return t};e.fn.translateCanvas=function vr(e){var t=this,n,r,i=new Nn(e),s;for(n=0;n<t[f];n+=1){r=Ln(t[n]);if(r){s=qn(t[n]);e=Kn(t[n],i,e,vr);i[yt]&&On(r,s);Fn(r,i,s[p])}}return t};e.fn.drawRect=function mr(e){var t=this,n,r,i=new Nn(e),u,a,h,p,d;for(n=0;n<t[f];n+=1){r=Ln(t[n]);if(r){e=Kn(t[n],i,e,mr);if(i[E]){_n(t[n],r,i);In(t[n],r,i,i[c],i[l]);r[g]();u=i.x-i[c]/2;a=i.y-i[l]/2;d=i.cornerRadius;if(d){i[ft]=s;h=i.x+i[c]/2;p=i.y+i[l]/2;h-u-2*d<0&&(d=(h-u)/2);p-a-2*d<0&&(d=(p-a)/2);r[Qt](u+d,a);r[rt](h-d,a);r.arc(h-d,a+d,d,3*pn/2,pn*2,o);r[rt](h,p-d);r.arc(h-d,p-d,d,0,pn/2,o);r[rt](u+d,p);r.arc(u+d,p-d,d,pn/2,pn,o);r[rt](u,a+d);r.arc(u+d,a+d,d,pn,3*pn/2,o)}else r.rect(u,a,i[c],i[l]);i[S]&&or(t[n],r,i);Hn(t[n],r,i)}}}return t};e.fn.drawArc=function gr(e){var t=this,n,r,i=new Nn(e);e=e||{};for(n=0;n<t[f];n+=1){r=Ln(t[n]);if(r){e=Kn(t[n],i,e,gr);if(i[E]){_n(t[n],r,i);In(t[n],r,i,i[G]*2);!i[kt]&&i.end===360&&(i.end=pn*2);if(n===0){i[R]*=i[B];i.end*=i[B];i[R]-=pn/2;i.end-=pn/2}r[g]();r.arc(i.x,i.y,i[G],i[R],i.end,i.ccw);i[S]&&or(t[n],r,i);Hn(t[n],r,i)}}}return t};e.fn[Gt]=function yr(e){var t=this,n,r,i=new Nn(e),o=i[c]*(4/3),u=i[l];i[ft]=s;for(n=0;n<t[f];n+=1){r=Ln(t[n]);if(r){e=Kn(t[n],i,e,yr);if(i[E]){_n(t[n],r,i);In(t[n],r,i,i[c],i[l]);r[g]();r[Qt](i.x,i.y-u/2);r[bt](i.x-o/2,i.y-u/2,i.x-o/2,i.y+u/2,i.x,i.y+u/2);r[bt](i.x+o/2,i.y+u/2,i.x+o/2,i.y-u/2,i.x,i.y-u/2);i[S]&&or(t[n],r,i);Hn(t[n],r,i)}}}return t};e.fn[Yt]=function br(e){var t=this,n,r,i=new Nn(e),o=2*pn/i.sides,u=o/2,a=u+pn/2,l=i[G]*vn(u),c,h,p;i.projection&&(i[Nt]=-i.projection);for(n=0;n<t[f];n+=1){r=Ln(t[n]);if(r){e=Kn(t[n],i,e,br);if(i[E]){_n(t[n],r,i);In(t[n],r,i,i[G]*2);r[g]();for(p=0;p<i.sides;p+=1){c=i.x+i[G]*vn(a);h=i.y+i[G]*dn(a);r[rt](c,h);if(i[Nt]){c=i.x+(l+ -l*i[Nt])*vn(a+u);h=i.y+(l+ -l*i[Nt])*dn(a+u);r[rt](c,h)}a+=o}i[S]&&or(t[n],r,i);i[ft]=s;Hn(t[n],r,i)}}}return t};e.fn.drawSlice=function wr(t){var n=this,r,i,o,u=new Nn(t),a,l,c;for(i=0;i<n[f];i+=1){r=e(n[i]);o=Ln(n[i]);if(o){t=Kn(n[i],u,t,wr);if(u[E]){_n(n[i],o,u);In(n[i],o,u,u[G]*2);if(i===0){u[R]*=u[B];u.end*=u[B];u[R]-=pn/2;u.end-=pn/2;while(u[R]<0)u[R]+=2*pn;while(u.end<0)u.end+=2*pn;u.end<u[R]&&(u.end+=2*pn);a=(u[R]+u.end)/2;l=u[G]*u.spread*vn(a);c=u[G]*u.spread*dn(a);u.x+=l;u.y+=c}o[g]();o.arc(u.x,u.y,u[G],u[R],u.end,u.ccw);o[rt](u.x,u.y);u[S]&&or(n[i],o,u);u[ft]=s;Hn(n[i],o,u)}}}return n};e.fn.drawLine=function Er(e){var t=this,n,r,i=new Nn(e),o,u,l;for(n=0;n<t[f];n+=1){r=Ln(t[n]);if(r){e=Kn(t[n],i,e,Er);if(i[E]){_n(t[n],r,i);In(t[n],r,i,0);o=1;r[g]();while(s){u=i["x"+o];l=i["y"+o];if(u===a||l===a)break;r[rt](u+i.x,l+i.y);o+=1}i[S]&&or(t[n],r,i);Hn(t[n],r,i)}}}return t};e.fn[Wt]=e.fn.drawQuad=function Sr(e){var t=this,n,r,i=new Nn(e),o,u,l,c,h;for(n=0;n<t[f];n+=1){r=Ln(t[n]);if(r){e=Kn(t[n],i,e,Sr);if(i[E]){_n(t[n],r,i);In(t[n],r,i,0);o=2;r[g]();r[Qt](i.x1+i.x,i.y1+i.y);while(s){u=i["x"+o];l=i["y"+o];c=i["cx"+(o-1)];h=i["cy"+(o-1)];if(u===a||l===a||c===a||h===a)break;r.quadraticCurveTo(c+i.x,h+i.y,u+i.x,l+i.y);o+=1}i[S]&&or(t[n],r,i);Hn(t[n],r,i)}}}return t};e.fn[rn]=function xr(e){var t=this,n,r,i=new Nn(e),o,u,l,c,h,p,d,v;for(n=0;n<t[f];n+=1){r=Ln(t[n]);if(r){e=Kn(t[n],i,e,xr);if(i[E]){_n(t[n],r,i);In(t[n],r,i,0);o=2;u=1;r[g]();r[Qt](i.x1+i.x,i.y1+i.y);while(s){l=i["x"+o];c=i["y"+o];h=i["cx"+u];p=i["cy"+u];d=i["cx"+(u+1)];v=i["cy"+(u+1)];if(l===a||c===a||h===a||p===a||d===a||v===a)break;r[bt](h+i.x,p+i.y,d+i.x,v+i.y,l+i.x,c+i.y);o+=1;u+=2}i[S]&&or(t[n],r,i);Hn(t[n],r,i)}}}return t};e.fn[tn]=function Tr(e){var t=this,n,r,i=new Nn(e),o,u,l,c,h;for(n=0;n<t[f];n+=1){r=Ln(t[n]);if(r){e=Kn(t[n],i,e,Tr);if(i[E]){_n(t[n],r,i);In(t[n],r,i,0);o=1;r[g]();c=i.x;h=i.y;r[Qt](i.x,i.y);while(s){u=i["a"+o];l=i["l"+o];if(u===a||l===a)break;u*=i[B];u-=pn/2;c+=l*vn(u);h+=l*dn(u);r[rt](c,h);o+=1}i[S]&&or(t[n],r,i);Hn(t[n],r,i)}}}return t};e.fn.drawText=function Nr(t){var n=this,r,i,s,o=new Nn(t),a,p,d,m;for(i=0;i<n[f];i+=1){r=e(n[i]);s=Ln(n[i]);if(s){t=Kn(n[i],o,t,Nr);if(o[E]){_n(n[i],s,o);s.textBaseline=o.baseline;s.textAlign=o.align;ur(s,o);i||(o[Ot]!==u?a=fr(s,o):a=o.text.toString().split("\n"));if(!i){ar(n[i],s,o,a);if(t&&o[L]){t[c]=o[c];t[l]=o[l]}d=o.x;o.align==="left"?o.respectAlign?o.x+=o[c]/2:d-=o[c]/2:o.align==="right"&&(o.respectAlign?o.x-=o[c]/2:d+=o[c]/2)}In(n[i],s,o,o[c],o[l]);for(p=0;p<a[f];p+=1){s[v]=o[v];m=o.y+p*o[l]/a[f]-(a[f]-1)*o[l]/a[f]/2;s.fillText(a[p],d,m);o[w]!==h&&(s[v]=h);s.strokeText(a[p],d,m)}if(o[S]){s[g]();s.rect(o.x-o[c]/2,o.y-o[l]/2,o[c],o[l]);or(n[i],s,o);s[V]()}Pn(s,o)}}}wn=o;return n};e.fn[q]=function Cr(e){var t=this,n,r,i;e===a||ln(e)==="object"&&!e[L]?r=new Nn(e):r=t[b](e);n=Ln(t[0]);if(n){ur(n,r);i=fr(n,r);Cr(t[0],n,r,i)}return r};e.fn[Q]=function kr(t){function T(e,n,i){if(e===0){m[c]===u&&m[z]===u&&(m[c]=m[z]=b[c]);m[l]===u&&m[_]===u&&(m[l]=m[_]=b[l]);if(t&&m[L]){t[c]=m[c];t[l]=m[l]}}if(m[z]!==u&&m[_]!==u&&m.sx!==u&&m.sy!==u){if(e===0){m[c]===u&&(m[c]=m[z]);m[l]===u&&(m[l]=m[_]);if(!m.cropFromCenter){m.sx+=m[z]/2;m.sy+=m[_]/2}m.sy-m[_]/2<0&&(m.sy=m[_]/2);m.sy+m[_]/2>b[l]&&(m.sy=b[l]-m[_]/2);m.sx-m[z]/2<0&&(m.sx=m[z]/2);m.sx+m[z]/2>b[c]&&(m.sx=b[c]-m[z]/2)}In(r[e],n,m,m[c],m[l]);n[Q](b,m.sx-m[z]/2,m.sy-m[_]/2,m[z],m[_],m.x-m[c]/2,m.y-m[l]/2,m[c],m[l])}else{In(r[e],n,m,m[c],m[l]);n[Q](b,m.x-m[c]/2,m.y-m[l]/2,m[c],m[l])}_n(r[e],n,m);n[g]();n.rect(m.x-m[c]/2,m.y-m[l]/2,m[c],m[l]);m[S]&&or(r[e],n,m);n[V]();n.stroke();Pn(n,m);Dn(n,i,m)}function N(n,r,i,u){return function(){T(r,i,u);m[Zt]&&m[Zt][y](n,t);if(m[L]){m._args[Xt]=u[p].masks[Y](0);m._next&&e(n)[H]({clear:o,resetFire:s,index:m._next})}}}var r=this,i,h,d,v,m=new Nn(t),b,w,x;x=m.source;w=x[O];if(x.src||w)b=x;else if(x)if(En[x]!==a)b=En[x];else{b=new n;b.src=x;En[x]=b}for(h=0;h<r[f];h+=1){i=r[h];d=Ln(r[h]);if(d){v=qn(r[h]);t=Kn(r[h],m,t,kr);if(m[E]&&b)if(b[nn]||w)N(i,h,d,v)();else{e(b).bind(Zt,N(i,h,d,v));b.src=b.src}}}return r};e.fn[on]=e.fn.pattern=function(r){function d(){f=s[on](a,o.repeat);o[Zt]&&o[Zt][y](i[0],f)}var i=this,s,o=new Nn(r),a,f,h,p;s=Ln(i[0]);if(s){p=o.source;if(cn(p)){a=e(zt)[0];a[c]=o[c];a[l]=o[l];h=Ln(a);p[y](a,h);d()}else{h=p[O];if(p.src||h)a=p;else{a=new n;a.src=p}if(a[nn]||h)d();else{e(a).bind(Zt,d);a.src=a.src}}}else f=u;return f};e.fn.createGradient=e.fn.gradient=function(t){var n=this,r,i=new Nn(t),s,o=[],l,c,h,p,d,v,m;r=Ln(n[0]);if(r){i.x1=i.x1||0;i.y1=i.y1||0;i.x2=i.x2||0;i.y2=i.y2||0;i.r1!==u||i.r2!==u?s=r.createRadialGradient(i.x1,i.y1,i.r1,i.x2,i.y2,i.r2):s=r.createLinearGradient(i.x1,i.y1,i.x2,i.y2);for(p=1;i["c"+p]!==a;p+=1)i["s"+p]!==a?o.push(i["s"+p]):o.push(u);l=o[f];o[0]===u&&(o[0]=0);o[l-1]===u&&(o[l-1]=1);for(p=0;p<l;p+=1){if(o[p]!==u){v=1;m=0;c=o[p];for(d=p+1;d<l;d+=1){if(o[d]!==u){h=o[d];break}v+=1}c>h&&(o[d]=o[p])}else if(o[p]===u){m+=1;o[p]=c+m*((h-c)/v)}s.addColorStop(o[p],i["c"+(p+1)])}}else s=u;return s};e.fn.setPixels=function Lr(e){var t=this,n,r,i,s=new Nn(e),o={},a,h,p,d;for(r=0;r<t[f];r+=1){n=t[r];i=Ln(n);if(i){e=Kn(n,s,e,Lr);In(t[r],i,s,s[c],s[l]);if(s[c]===u||s[l]===u){s[c]=n[c];s[l]=n[l];s.x=s[c]/2;s.y=s[l]/2}if(s[c]!==0&&s[l]!==0){a=i.getImageData(s.x-s[c]/2,s.y-s[l]/2,s[c],s[l]);h=a.data;d=h[f];o=[];if(s.each)for(p=0;p<d;p+=4){o.r=h[p];o.g=h[p+1];o.b=h[p+2];o.a=h[p+3];s.each[y](n,o);h[p]=o.r;h[p+1]=o.g;h[p+2]=o.b;h[p+3]=o.a}i.putImageData(a,s.x-s[c]/2,s.y-s[l]/2);i[lt]()}}}return t};e.fn.getCanvasImage=function(t,n){var r=this[0];n===a&&(n=1);return r&&r.toDataURL?r.toDataURL("image/"+t,n):u};e.fn.detectPixelRatio=function(n){var r=this,i,o,u,a,h,p,d,v,m,g;for(u=0;u<r[f];u+=1){o=r[u];i=e(r[u]);a=Ln(o);g=qn(r[u]);if(!g.scaled){h=window.devicePixelRatio||1;p=a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||a.backingStorePixelRatio||1;d=h/p;if(d!==1){v=o[c];m=o[l];o[c]=v*d;o[l]=m*d;o[Ct][c]=v+"px";o[Ct][l]=m+"px";a.scale(d,d)}g[Rt]=d;g.scaled=s;n&&n[y](o,d)}}return r};e.support.canvas=e(zt)[0][O]!==a;Cn.defaults=un;Cn.detectEvents=or;Cn[V]=Hn;Cn.getTouchEventName=nr;e[ut]=Cn})(jQuery,document,Image,Math,parseFloat,!0,!1,null);